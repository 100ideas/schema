{
    "$id": "https://stencila.github.com/schema/01-draft/Environment.schema.json",
    "$schema": "https://json-schema.org/draft-07/schema",
    "title": "Environment",
    "description": "A computational environment.",
    "@id": "stencila:Environment",
    "type": "object",
    "properties": {
        "type": { 
            "description": "The type of document",
            "const": "Environment"
        },        
        "name": { 
            "description": "The name of the environment.",
            "@id": "schema:name",
            "allOf": [{ "$ref": "name.schema.json" }]
        },
        "description": { 
            "description": "Description of the environment.",
            "@id": "schema:description",
            "allOf": [{ "$ref": "#/definitions/description" }]
        },
        "extends": {
            "description": "Other environments that this environment extends by adding or removing packages.",
            "@id": "stencila:extends",
            "allOf": [{ "$ref": "#/definitions/environments" }]
        },
        "adds": {
            "description": "The packages that this environment adds to the base environments listed under `extends` (if any).",
            "@id": "stencila:adds",
            "allOf": [{ "$ref": "#/definitions/packages" }]
        },
        "removes": {
            "description": "The packages that this environment removes from the base environments listed under `extends` (if any).",
            "@id": "stencila:removes",
            "allOf": [{ "$ref": "#/definitions/packages" }]
        },
        "source": {
            "description": "Source of environment definition. For example, a URL to a Dockerfile, a path to Singularity recipe file, or a path to a filesystem folder.",
            "@id": "stencila:source",
            "allOf": [{ "$ref": "Source.schema.json" }]
        }
    },
    "required": ["name"],
    "definitions": {
        "description": {
            "type": "string"
        },
        "environments": {
            "type": "array",
            "items": {
                "anyOf": [
                    { "$ref": "name.schema.json" },
                    { "$ref": "url.schema.json" },
                    { "$ref": "Environment.schema.json" }
                ]
            },
            "$comment": "An array of environment names, URLs or instances."
        },
        "packages": {
            "type": "array",
            "items": {
                "anyOf": [
                    { "$ref": "name.schema.json" },
                    { "$ref": "url.schema.json" },
                    { "$ref": "Package.schema.json" }
                ]
            },
            "$comment": "An array of package names, URLs or instances."
        }
    }
}
